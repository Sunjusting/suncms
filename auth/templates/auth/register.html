<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!--><html lang="en" class="no-js"><!--<![endif]-->

<!-- BEGIN HEAD -->
<head>
	<meta charset="utf-8"/>
	<title>登录 | CCPIT CMS</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
	<meta content="" name="description"/>
	<meta content="" name="author"/>
	<meta name="MobileOptimized" content="320">

	<!-- BEGIN GLOBAL MANDATORY STYLES -->
	<link rel="stylesheet" type="text/css" href="/static/plugins/font-awesome/css/font-awesome.min.css" />
	<link rel="stylesheet" type="text/css" href="/static/plugins/bootstrap/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css"  href="/static/plugins/uniform/css/uniform.default.css" />
	
	<link rel="stylesheet" type="text/css"  href="/static/css/style-metronic.css" />
	<link rel="stylesheet" type="text/css"  href="/static/css/style.css" />
	<link rel="stylesheet" type="text/css"  href="/static/css/themes/default.css" />
	<link rel="stylesheet" type="text/css"  href="/static/css/pages/login.css" />

</head>


<!-- BEGIN BODY -->
<body class="login">	
	<section class="container" style="margin-top:60px;background-color:#fff;">
		<div class="row">
			<div class="col-md-2"></div>
			<div class="col-md-8" style="text-align:center;font-size:32px;padding:30px 0px">注册</div>
		</div>
		<div class="row">
			<div class="col-md-3">
				
			</div>			
			<div class="col-md-6">
				<!-- BEGIN LOGIN -->
				<div class="">
					<!-- BEGIN LOGIN FORM -->
					<form class="form-horizontal" role="form" action="" method="post" id="register-form">
						{% csrf_token %}
						<div class="form-body">
							<div class="form-group" id="inUsername">
								<label class="col-md-3 control-label">用户名</label>
								<div class="col-md-9">
									{{ form.username }}
									<span class="help-block red" id="userNameHelp">请用正确的邮件地址，我们将会给您发送激活邮件</span>
								</div>
							</div>								
							<div class="form-group" id="inPass">
								<label class="col-md-3 control-label">密 码</label>
								<div class="col-md-9">
									{{ form.password }}
								</div>
							</div>
							<div class="form-group" id="inConfirmPass">
								<label class="col-md-3 control-label">确认密码</label>
								<div class="col-md-9">
									{{form.confirmPassword}}
									<span class="help-block" id="passHelp">请输入相同的密码</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">姓 名</label>
								<div class="col-md-9">
									{{form.nickname}}
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">性 别</label>
								<div class="radio-list col-md-9">
									{% for radio in form.sex %}
									<label class="radio-inline">
										<div class="radio">
											<span class="">
												{{ radio.tag}}
											</span>
										</div>
										{{radio.choice_label}}													
									</label>
									{% endfor %}
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">工作单位</label>
								<div class="col-md-9">
									{{form.agency}}
								</div>
							</div>
							<div class="form-group">
								<label class="col-md-3 control-label">联系电话</label>
								<div class="col-md-9">
									{{form.phone}}
								</div>
							</div>								
							<div class="form-group">
								<label class="col-md-3 control-label">联系地址</label>
								<div class="col-md-9">
									{{form.address}}
								</div>
							</div>								
						</div>
						<div class="form-actions" style="text-align:center">
							<button class="btn green btn-lg" id="submit-register-btn">
								注 册
							</button>
						</div>
					</form>
								
					
					<!-- END LOGIN FORM -->   
				</div>	
				<!-- END LOGIN -->
			</div>
			<div class="col-md-3">
				
			</div>
			
		</div>
	</section>

	<!-- BEGIN FOOTER -->
	<div class="footer">
		<div class="_footer-inner" style="text-align:center;padding-top:80px;color:#fff">
			2016 &copy; China Council for Promotion International Trade 
		</div>		
	</div>


	<!-- END FOOTER -->
	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
	<!-- BEGIN CORE PLUGINS -->
	<!--[if lt IE 9]>
	<script src="/static/plugins/respond.min.js"></script>
	<script src="/static/plugins/excanvas.min.js"></script> 
	<![endif]-->
	<script src="/static/plugins/jquery-1.10.2.min.js" type="text/javascript"></script>
	<script src="/static/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
	<script src="/static/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>	
	
	<script src="/static/plugins/jquery-validation/dist/jquery.validate.min.js" type="text/javascript"></script>	
	<script src="/static/plugins/jquery.cookie.min.js" type="text/javascript"></script>
	<script src="/static/plugins/select2/select2.min.js" type="text/javascript"></script>
	<script src="/static/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>

	<script src="/static/scripts/app.js" type="text/javascript"></script>
	<script src="/static/scripts/login.js" type="text/javascript"></script>
	
	
	<!-- END PAGE LEVEL SCRIPTS -->
	
	<script type="text/javascript">		
		jQuery(document).ready(function() {     
			App.init();
			Login.init();
		});

	    $("#submit-register-btn").on("click",function(){
	    	if(checkUsername() && checkPassword()){
	    		$("#register-form").submit();
	    	}else{
	    		alert("注册表单没有通过验证，请检查重填后提交");
	    	}	    	
	    });

	    function checkUsername(){
	    	var username = $("#inputEmail").val();
			var regEmail = /^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g;
			if(regEmail.test(username)){
				return true;
			}else{
				return false;
			}
	    }

	    function checkPassword(){
	    	var passwd1 = $("#inputPassword").val();
			var passwd2 = $("#confirmPassword").val();
			if(passwd1!=passwd2){				
				return false;
			}else{
				return true;
			}
	    }


	    $("#inputEmail").blur(function(){
			var username = $("#inputEmail").val();
			var regEmail = /^([0-9A-Za-z\-_\.]+)@([0-9a-z]+\.[a-z]{2,3}(\.[a-z]{2})?)$/g;
			if(regEmail.test(username)){
				var url = "{% url 'checkUser' %}";
				if(username){
					$.get( url,{username:username},function(v){
						if( v == 'True' ){	
							$("#userNameHelp").html("该邮件已经被注册，请更换邮件注册。");
							$("#inUsername").addClass("has-error");
						}
					});			
				}
			}else{
				$("#userNameHelp").html("非法的邮箱地址。");
				$("#inUsername").addClass("has-error");
			}						
		});
		
		$("#confirmPassword").blur(function(){
			var passwd1 = $("#inputPassword").val();
			var passwd2 = $("#confirmPassword").val();
			if(passwd1!=passwd2){				
				$("#passHelp").html("输入的密码与第一次不同，请重新输入");
				$("#inConfirmPass").addClass("has-error");
			}			
		});
		
		$("#confirmPassword").focus(function(){
			$("#inConfirmPass").removeClass("has-error");
			$("#passHelp").html("");
		});
		$("#inputEmail").focus(function(){
			$("#inUsername").removeClass("has-error");
			$("#userNameHelp").html("请用正确的邮件地址，我们将会给您发送激活邮件");
		});

	</script>
	



</body>

<!-- END BODY -->

</html>